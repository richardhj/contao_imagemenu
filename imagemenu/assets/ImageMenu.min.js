/* ImageMenu, (c) Samuel Birch, see <https://github.com/samuelbirch/ImageMenu/pull/1>, MIT license */
var ImageMenu=new Class({Implements:[Options,Events],options:{openWidth:200,openOnClick:true,transition:Fx.Transitions.Quad.easeOut,duration:400,open:null,border:0},initialize:function(e,d){this.elements=$$(e);this.setOptions(d);this.widths={closed:this.elements[0].getStyle("width").toInt(),openSelected:this.options.openWidth};this.widths.openOthers=Math.round(((this.widths.closed*this.elements.length)-(this.widths.openSelected+this.options.border))/(this.elements.length-1));this.fx=new Fx.Elements(this.elements,{link:"cancel",duration:this.options.duration,transition:this.options.transition});var a=this;this.elements.each(function(g,f){g.addEvents({mouseenter:function(h){a.reset(f);a.fireEvent("open",[g,f])},mouseleave:function(h){a.reset(a.options.open);a.fireEvent("close",[g,f])}});if(a.options.openOnClick){g.addEvent("click",function(i){a.options.open=(a.options.open==f)?null:f;var h=(a.options.open==f)?"Close":"Open";a.fireEvent("click"+h,[this.href,f]).fireEvent("click",[this.href,f])})}});if(this.options.open!=null){var c=typeOf(this.options.open)=="number",b=c?this.options.open:this.elements.indexOf(document.id(this.options.open));this.reset(b)}},reset:function(b){var a=typeOf(b)=="number",d={},c;if(a){c=this.widths.openOthers;if((b+1)==this.elements.length){c+=this.options.border}}else{c=this.widths.closed}this.elements.each(function(g,f){var e=c;if(f==(this.elements.length-1)){e=c+5}d[f]={width:e}},this);if(a){d[b]={width:this.widths.openSelected}}this.fx.start(d)}});